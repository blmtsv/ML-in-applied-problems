# Линейная регрессия
Пусть функция потерь обозначена как $S(y_i, \Bar{y}_i)$, где $y_i$ – "реальное"значение переменной, а $\b{y}_i$ – регрессионное предсказание. Как правило, все функции потерь рассчитывают разницу между yi и ybi. Например, для MSE функция потерь выглядит так:
SMSE =
1
n
Pn
i=0(yi − ybi)
2
(n – количество объектов выборки).
Как рассчитать ybi? Линейная регрессия (на плоскости): ybi = axi + b, а
значит SMSE =
1
n
Pn
i=0(yi − (axi + b))2
;

Зная предсказание x, нам необходимо вычислить коэффициенты a и b.
Это можно сделать с помощью алгоритма градиентного спуска.
Сначала вычислим частные производные:
∂SMSE
∂a =
1
n
Xn
i=0
2(yi − (axi + b))(−xi) = −2
n
Xn
i=0
xi(yi − (axi + b))

∂SMSE
∂b =
−2
n
Xn
i=0
(yi − (axi + b))

;
Пусть дан шаг алгоритма ε, количество итераций p и исходные значения
a = a0, b = b0. Тогда, согласно градиенту, можно итерационно для всех
j = 1, p вычислять

aj = aj−1 − ε
∂SMSE
∂a |a=aj−1

bj = bj−1 − ε
∂SMSE
∂b |b=bj−1

Тогда a = ap, b = bp и уравнение аппроксимирующей прямой будет
выглядеть как y(x) = ax + b.

1. Используйте датасет sklearn.datasets.load_diabetes(). Разобрать-
ся с тем, какие данные в нём содержатся, а также какая переменная явля-
ется целевой, можно по ссылке;

2. Используйте любой известный алгоритм понижения размерности (на-
пример, LDA) для того, чтобы снизить количество признаков до одного

1

(вариант примитивнее – взять любую переменную исходного датасета, ко-
торую Вы считаете наиболее значимой).

3. Реализуйте алгоритм линейной регрессии с использованием гради-
ентного спуска и функциями потерь SMSE (см. выше) и SMAE (продиффе-
ренцируйте самостоятельно). Обратите внимание, что для данного пункта

запрещается использовать готовые реализации методов (LinearRegression,
mean_squared_error и т.д.);
4. Теперь постройте прогнозы, используя стандартную реализацию LinearRegression
из sklearn;
5. Сравните основные метрики качества для "собственной"реализации и
варианта из sklearn – MSE, MSLE, MAE, R2

, RMSE. Какой из двух алго-
ритмов оказался эффективнее? Какой менее подвержен переобучению?

6. Постройте на плоскости графики прямых (регрессий) для "собствен-
ной"реализации и варианта из sklearn.

Кластеризация: о вкусах не спорят

Наверняка у каждого из нас есть любимый жанр музыки, песня или испол-
нитель.

Также наверняка мы хоть раз в жизни спорили с другими людьми о
том, что именно наш любимый жанр или исполнитель – самый лучший и
слушабельный.
Но так ли велика разница между различными жанрами музыки, если
мы будем основываться только на фрагментах текста? В этом задании вам
предлагается провести небольшое исследование на подобную тему.
Выберите несколько жанров музыки и самостоятельно составьте датасет,
включающий в себя следующую информацию: отрывок некоторой песни
(например, припев) и жанр этой песни. Вместо жанра можно использовать
также определенных исполнителей.
Возможный датасет (пример No1):
text genre
death blood satan... rock
money girls money... rap
you are the best... pop
death again death... rock
Возможный датасет (пример No2):
text artist
death blood satan... SlipKnot
money girls money... Lil Pump
you are the best... Katy Perry
death again death... SlipKnot

В данном примере жанр (или исполнитель) являются кластером, а на-
ша задача – по исходным данным провести кластеризацию, то есть отне-
сти песню к определенному жанру (исполнителю) по отрывку из её текста.

2

Требования к датасету: минимум 150 объектов (песен) и от 4 до 20
кластеров (жанров или исполнителей).

Как набирать данные? Попробуйте найти тематические сайты с тек-
стами песен, напишите небольшой веб-парсер, выкачивающий тексты для

тех исполнителей, которых вы укажете. Также можно делать это руками
без скриптов – смотрите сами, какой вариант Вам кажется быстрее.

Что использовать? Кластеризацию необходимо проводить методом k-
means с использованием любых вспомогательных средств (TF-IDF, MiniBatch,

нейронные сети, ...).

На что ещё обратить внимание? Для хорошего результата все тек-
сты должны быть приведены к нижнему регистру и очищены от всех знаков

препинания ("слово1 слово2 слово3 ..."). Перед самой кластеризацией тек-
сты необходимо прогнать через Encoder (OneHot, Label, ...) – вспоминаем

Д/З No2.

После разделения на кластеры сверьте то, насколько предсказание ал-
горитма совпало с реальным жанром (исполнителем) песни.

Согласны ли Вы с тем, что разделять песни по жанрам только на основе
текста – это плохая идея?
